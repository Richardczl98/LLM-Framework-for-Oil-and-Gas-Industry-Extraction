import unittest
from collections import OrderedDict
import numpy as np
from pathlib import Path

from config import TEST_DIR
from eval.evaluation_metric import EvaluationMetric


class TestEvaluation(unittest.TestCase):
    def setUp(self) -> None:
        print('\n')

    def test_evaluation_with_gt(self):
        pred = OrderedDict([('Niger Delta', OrderedDict([('Downhole pump', [np.nan, '', '', 'not_mentioned']), ('Water reinjection', [np.nan, '', '', 'not_mentioned']), ('Natural gas reinjection', [np.nan, '', '', 'not_mentioned']), ('Water flooding', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas lifting', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas flooding', [np.nan, '', '', 'not_mentioned']), ('Steam flooding', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (non-integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Field location (Country)', ['Nigeria', '', 'Reference page and content', 'Nigeria@Reference page and content']), ('Field name', ['Niger Delta', '', '', 'Niger Delta']), ('Field age', ['58', '', '', '58']), ('Field depth', [np.nan, '', '', 'not_mentioned']), ('Oil production volume', [np.nan, '', '', 'not_mentioned']), ('Number of producing wells', [np.nan, '', '', 'not_mentioned']), ('Number of water injecting wells', [3.0, '', 'Reference page and content', '3@Reference page and content']), ('Production tubing diameter', [np.nan, '', '', 'not_mentioned']), ('Injector tubing diameter', ['3-1/2” or 2-7/8”', '', 'Reference page and content', '3-1/2” or 2-7/8”@Reference page and content']), ('Bottomhole pressure', [np.nan, '', '', 'not_mentioned']), ('Reservoir pressure', [3164.7, 'psia', 'Reference page and content', '3150psi@Reference page and content']), ('Reservoir temperature', [np.nan, '', '', 'not_mentioned']), ('Offshore', [0.0, '', 'Reference page and content', '0@Reference page and content']), ('API gravity (oil at standard pressure and temperature, or "dead oil")', [23.0, 'api', 'Reference page 1 and It is a normally pressured system with initial datum pressure of 3150psi. Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).', '23 API@Reference page 1 and It is a normally pressured system with initial datum pressure of 3150psi. Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).']), ('N2', [np.nan, '', '', 'not_mentioned']), ('CO2', [np.nan, '', '', 'not_mentioned']), ('C1', [np.nan, '', '', 'not_mentioned']), ('C2', [np.nan, '', '', 'not_mentioned']), ('C3', [np.nan, '', '', 'not_mentioned']), ('C4+', [np.nan, '', '', 'not_mentioned']), ('H2S', [np.nan, '', '', 'not_mentioned']), ('Gas-to-oil ratio (GOR)', [np.nan, '', '', 'not_mentioned']), ('Water-to-oil ratio (WOR)', [np.nan, '', '', 'not_mentioned']), ('Water injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas lifting injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas flooding injection ratio', [np.nan, '', '', 'not_mentioned']), ('Flood gas', [np.nan, '', '', 'not_mentioned']), ('Fraction of CO2 breaking through to producers', [np.nan, '', '', 'not_mentioned']), ('Source of makeup CO2', [np.nan, '', '', 'not_mentioned']), ('Percentage of sequestration credit assigned to the oilfield', [np.nan, '', '', 'not_mentioned']), ('Steam-to-oil ratio (SOR)', [np.nan, '', '', 'not_mentioned']), ('Fraction of required fossil electricity generated onsite', [np.nan, '', '', 'not_mentioned']), ('Fraction of remaining natural gas reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of produced water reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via cogeneration', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via solar thermal', [np.nan, '', '', 'not_mentioned']), ('Heater/treater', [np.nan, '', '', 'not_mentioned']), ('Stabilizer column', [np.nan, '', '', 'not_mentioned']), ('Upgrader type', [np.nan, '', '', 'not_mentioned']), ('Flaring-to-oil ratio', [np.nan, '', '', 'not_mentioned']), ('Venting fraction (purposeful venting of post-flare gas)', [np.nan, '', '', 'not_mentioned']), ('Volume fraction of diluent', [np.nan, '', '', 'not_mentioned']), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', [np.nan, '', '', 'not_mentioned']), ('Reservoir permeability', [np.nan, '', '', 'not_mentioned']), ('Reservoir thickness', [np.nan, '', '', 'not_mentioned']), ('Wellhead pressure', [np.nan, '', '', 'not_mentioned']), ('Wellhead temperature', [np.nan, '', '', 'not_mentioned'])])), ('Niger Delta_1', OrderedDict([('Downhole pump', [np.nan, '', '', 'not_mentioned']), ('Water reinjection', [np.nan, '', '', 'not_mentioned']), ('Natural gas reinjection', [np.nan, '', '', 'not_mentioned']), ('Water flooding', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas lifting', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas flooding', [np.nan, '', '', 'not_mentioned']), ('Steam flooding', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (non-integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Field location (Country)', ['Nigeria', '', 'Reference page and content', 'Nigeria@Reference page and content']), ('Field name', ['Niger Delta_1', '', '', 'Niger Delta_1']), ('Field age', ['13', '', '', '13']), ('Field depth', [np.nan, '', '', 'not_mentioned']), ('Oil production volume', [3600.0, 'bbl/d', 'Reference page and content', '3600 bopd@Reference page and content']), ('Number of producing wells', [8.0, '', 'Reference page and content', '8@Reference page and content']), ('Number of water injecting wells', [3.0, '', 'Reference page and content', '3@Reference page and content']), ('Production tubing diameter', ['2-7/8', '', 'Reference page and content', '2-7/8"@Reference page and content']), ('Injector tubing diameter', ['3-1/2 or 2-7/8', '', 'Reference page and content', '3-1/2" or 2-7/8"@Reference page and content']), ('Bottomhole pressure', [np.nan, '', '', 'not_mentioned']), ('Reservoir pressure', [3164.7, 'psia', 'Reference page and content', '3150psi@Reference page and content']), ('Reservoir temperature', [np.nan, '', '', 'not_mentioned']), ('Offshore', [0.0, '', 'Reference page and content', '0@Reference page and content']), ('API gravity (oil at standard pressure and temperature, or "dead oil")', [23.0, 'api', 'Reference page 1 and Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).', '23 API@Reference page 1 and Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).']), ('N2', [np.nan, '', '', 'not_mentioned']), ('CO2', [np.nan, '', '', 'not_mentioned']), ('C1', [np.nan, '', '', 'not_mentioned']), ('C2', [np.nan, '', '', 'not_mentioned']), ('C3', [np.nan, '', '', 'not_mentioned']), ('C4+', [np.nan, '', '', 'not_mentioned']), ('H2S', [np.nan, '', '', 'not_mentioned']), ('Gas-to-oil ratio (GOR)', [np.nan, '', '', 'not_mentioned']), ('Water-to-oil ratio (WOR)', ['1.14', '', 'Reference page 1 and content: "Currently 2010), the reservoir block is produced by 8 conduits at 3,600 bopd, 3.5 Mmscfd and 40% avg BSW."', '1.14@Reference page 1 and content: "Currently 2010), the reservoir block is produced by 8 conduits at 3,600 bopd, 3.5 Mmscfd and 40% avg BSW."']), ('Water injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas lifting injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas flooding injection ratio', [np.nan, '', '', 'not_mentioned']), ('Flood gas', [np.nan, '', '', 'not_mentioned']), ('Fraction of CO2 breaking through to producers', [np.nan, '', '', 'not_mentioned']), ('Source of makeup CO2', [np.nan, '', '', 'not_mentioned']), ('Percentage of sequestration credit assigned to the oilfield', [np.nan, '', '', 'not_mentioned']), ('Steam-to-oil ratio (SOR)', [np.nan, '', '', 'not_mentioned']), ('Fraction of required fossil electricity generated onsite', [np.nan, '', '', 'not_mentioned']), ('Fraction of remaining natural gas reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of produced water reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via cogeneration', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via solar thermal', [np.nan, '', '', 'not_mentioned']), ('Heater/treater', [np.nan, '', '', 'not_mentioned']), ('Stabilizer column', [np.nan, '', '', 'not_mentioned']), ('Upgrader type', [np.nan, '', '', 'not_mentioned']), ('Flaring-to-oil ratio', [np.nan, '', '', 'not_mentioned']), ('Venting fraction (purposeful venting of post-flare gas)', [np.nan, '', '', 'not_mentioned']), ('Volume fraction of diluent', [np.nan, '', '', 'not_mentioned']), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', [np.nan, '', '', 'not_mentioned']), ('Reservoir permeability', [np.nan, '', '', 'not_mentioned']), ('Reservoir thickness', [np.nan, '', '', 'not_mentioned']), ('Wellhead pressure', [np.nan, '', '', 'not_mentioned']), ('Wellhead temperature', [np.nan, '', '', 'not_mentioned'])]))])
        gt = OrderedDict()
        file_path = Path(TEST_DIR, 'eval/result')
        metric = EvaluationMetric()

        metric.evaluate(str(file_path), pred, gt)
        print(metric.dt_field_errors)

    def test_evaluation_case_1(self):
        pred = OrderedDict([('Buracica', OrderedDict([('Downhole pump', [np.nan, '', '', 'not_mentioned', 'success']), ('Water reinjection', [1.0, '', '', 'not_mentioned | mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Natural gas reinjection', [np.nan, '', '', 'not_mentioned', 'success']), ('Water flooding', [1.0, '', 'Page 1, Reconcavo, Sergipe, and Potiguar basins | Page 4 - Previously, Canto do Amaro and Carmópolis have been waterflooded for enough time to see a second production decline. An immiscible CO2 injection started in Buracica in 1991, but its results were short-lived. Polymer flooding was chosen, then as the tertiary method of preference and a pilot test was developed. | Reference page 6', 'mentioned@Page 1, Reconcavo, Sergipe, and Potiguar basins | not_mentioned | mentioned@Page 4 - Previously, Canto do Amaro and Carmópolis have been waterflooded for enough time to see a second production decline. An immiscible CO2 injection started in Buracica in 1991, but its results were short-lived. Polymer flooding was chosen, then as the tertiary method of preference and a pilot test was developed. | mentioned@Reference page 6 | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Gas lifting', [np.nan, '', '', 'not_mentioned', 'success']), ('Gas flooding', [1.0, '', 'Field Development Plan - Buracica (Portuguese)', 'not_mentioned | mentioned@Field Development Plan - Buracica (Portuguese) | not_mentioned | not_mentioned', 'success']), ('Steam flooding', [1.0, '', 'Field Development Plan - Buracica (Portuguese) Page 15', 'not_mentioned | mentioned@Field Development Plan - Buracica (Portuguese) Page 15 | not_mentioned | not_mentioned', 'success']), ('Oil sands mine (integrated with upgrader)', [np.nan, '', '', 'not_mentioned', 'success']), ('Oil sands mine (non-integrated with upgrader)', [np.nan, '', '', 'not_mentioned', 'success']), ('Field location (Country)', ['Brazil', '', 'Page 1, Abstract | Page 5 oil & gas exploration and production in Brazil. | Page 6, Buracica field production history | Page 9, An example of surfactant flooding being applied is in Wolfcamp on two different wells. Wolfcamp and Potiguar basins have a similar lithology in terms of clay content and its salinity (Bhandari et al, 2018). | Page 13 and Buracica, Carmópolis and Canto do Amaro fields presented almost none to low increase in production. | Page 15 Bampi, D., & Costa, O. J. (2010). Marlim Field: An Optimization Study on a Mature Field. (SPE 139376) | Page 16 Geochemical assessment of oils from the Mero Field, Santos Basin, Brazil. Organic Geochemistry, 130, 1–13. | page 16, End of the Reference Text', 'Brazil@Page 1, Abstract | Brazil@Page 5 oil & gas exploration and production in Brazil. | Brazil@Page 6, Buracica field production history | not_mentioned@Page 9, An example of surfactant flooding being applied is in Wolfcamp on two different wells. Wolfcamp and Potiguar basins have a similar lithology in terms of clay content and its salinity (Bhandari et al, 2018). | Brazil@Page 13 and Buracica, Carmópolis and Canto do Amaro fields presented almost none to low increase in production. | Brazil@Page 15 Bampi, D., & Costa, O. J. (2010). Marlim Field: An Optimization Study on a Mature Field. (SPE 139376) | Brazil@Page 16 Geochemical assessment of oils from the Mero Field, Santos Basin, Brazil. Organic Geochemistry, 130, 1–13. | not_mentioned@page 16, End of the Reference Text', 'success']), ('Field name', ['Buracica', '', '', 'Buracica', 'success']), ('Field age', ['64', '', 'Page 4, The main hydrocarbon reservoirs at both Recôncavo and Potiguar basins are composed of deltaic, fluvial-deltaic, fluvial-aeolian, and turbidites sandstones. The Sergipe basin has a diversity of rocks as hydrocarbon reservoirs. These include sandstone reservoirs (fluvial, deltaic, fluvial-deltaic) in its majority and some turbidites, conglomerates, and carbonates. Buracica, Carmópolis, and Canto do Amaro were chosen to be reviewed in details due to their long producing life (since 1959, 1963, and 1986, respectively).', 'not_mentioned | 64@Page 4, The main hydrocarbon reservoirs at both Recôncavo and Potiguar basins are composed of deltaic, fluvial-deltaic, fluvial-aeolian, and turbidites sandstones. The Sergipe basin has a diversity of rocks as hydrocarbon reservoirs. These include sandstone reservoirs (fluvial, deltaic, fluvial-deltaic) in its majority and some turbidites, conglomerates, and carbonates. Buracica, Carmópolis, and Canto do Amaro were chosen to be reviewed in details due to their long producing life (since 1959, 1963, and 1986, respectively). | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Field depth', [1050.0, 'ft', 'Page 4', 'not_mentioned | 1,050 ft@Page 4 | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Oil production volume', [np.nan, '', '', 'not_mentioned | Not mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Number of producing wells', [0, '', 'Page 1, Abstract', 'None@Page 1, Abstract | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'error']), ('Number of water injecting wells', [np.nan, '', '', 'not_mentioned', 'success']), ('Production tubing diameter', [np.nan, '', '', 'not_mentioned', 'success']), ('Injector tubing diameter', [np.nan, '', '', 'not_mentioned', 'success']), ('Bottomhole pressure', [np.nan, '', '', 'not_mentioned', 'success']), ('Reservoir pressure', [np.nan, '', '', 'not_mentioned', 'success']), ('Reservoir temperature', [140.0, '°f', 'Page 4', 'not_mentioned | 140⁰F@Page 4 | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Offshore', ['1.0 | 0.0 | 0.0 | 1.0 | 1.0 | 1.0 | 0.0', '', 'Page 1, line 18-20 | Page 4, Reservoir Rock and Fluid Properties for Buracica, Canto do Amaro, and Carmópolis Fields | Page 6, Buracica field production history | Page 12, last paragraph | Page 13, Both Jubarte and Marlim have achieved success with waterflooding. They also present a continuous decline curve since reaching peak production. Polymer flooding is the solution proposed in these cases. | Page 15, ANP - Agência Nacional do Petróleo, Gás Natural e Biocombustíveis (2016). Field Development Plan - Buracica (Portuguese) | reference page 16, Silva, Thamy C.S.D., Goncalves, Felix T.T., Bedregal, Ricardo P, Cuinas, Elio P Filho, & Landau, Luiz (2004). Estimating the remaining potential of the Recôncavo basin, Brazil: a basin modeling and material balance approach. Brazil. 2004.07.008', '1@Page 1, line 18-20 | 0@Page 4, Reservoir Rock and Fluid Properties for Buracica, Canto do Amaro, and Carmópolis Fields | 0@Page 6, Buracica field production history | 1@Page 12, last paragraph | 1@Page 13, Both Jubarte and Marlim have achieved success with waterflooding. They also present a continuous decline curve since reaching peak production. Polymer flooding is the solution proposed in these cases. | 1@Page 15, ANP - Agência Nacional do Petróleo, Gás Natural e Biocombustíveis (2016). Field Development Plan - Buracica (Portuguese) | not_mentioned | 0@reference page 16, Silva, Thamy C.S.D., Goncalves, Felix T.T., Bedregal, Ricardo P, Cuinas, Elio P Filho, & Landau, Luiz (2004). Estimating the remaining potential of the Recôncavo basin, Brazil: a basin modeling and material balance approach. Brazil. 2004.07.008', 'success']), ('API gravity (oil at standard pressure and temperature, or "dead oil")', [np.nan, '', '', 'not_mentioned', 'success']), ('N2', [np.nan, '', '', 'not_mentioned', 'success']), ('CO2', [np.nan, '', '', 'not_mentioned', 'success']), ('C1', [np.nan, '', '', 'not_mentioned', 'success']), ('C2', [np.nan, '', '', 'not_mentioned', 'success']), ('C3', [np.nan, '', '', 'not_mentioned', 'success']), ('C4+', [np.nan, '', '', 'not_mentioned', 'success']), ('H2S', [np.nan, '', '', 'not_mentioned', 'success']), ('Gas-to-oil ratio (GOR)', [np.nan, '', '', 'not_mentioned', 'success']), ('Water-to-oil ratio (WOR)', [np.nan, '', '', 'not_mentioned', 'success']), ('Oil_Production_BOPD', [np.nan, '', '', 'not_mentioned', 'success']), ('Gas_Production_Mmscfd', [np.nan, '', '', 'not_mentioned', 'success']), ('Water injection ratio', [np.nan, '', '', 'not_mentioned', 'success']), ('Gas lifting injection ratio', [np.nan, '', '', 'not_mentioned', 'success']), ('Gas flooding injection ratio', [np.nan, '', '', 'not_mentioned', 'success']), ('Flood gas', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of CO2 breaking through to producers', [np.nan, '', '', 'not_mentioned', 'success']), ('Source of makeup CO2', [np.nan, '', '', 'not_mentioned', 'success']), ('Percentage of sequestration credit assigned to the oilfield', [np.nan, '', '', 'not_mentioned', 'success']), ('Steam-to-oil ratio (SOR)', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of required fossil electricity generated onsite', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of remaining natural gas reinjected', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of produced water reinjected', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of steam generation via cogeneration', [np.nan, '', '', 'not_mentioned', 'success']), ('Fraction of steam generation via solar thermal', [np.nan, '', '', 'not_mentioned', 'success']), ('Heater/treater', [np.nan, '', '', 'not_mentioned', 'success']), ('Stabilizer column', [np.nan, '', '', 'not_mentioned', 'success']), ('Upgrader type', [np.nan, '', '', 'not_mentioned', 'success']), ('Flaring-to-oil ratio', [np.nan, '', '', 'not_mentioned', 'success']), ('Venting fraction (purposeful venting of post-flare gas)', [np.nan, '', '', 'not_mentioned', 'success']), ('Volume fraction of diluent', [np.nan, '', '', 'not_mentioned', 'success']), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', [np.nan, '', '', 'not_mentioned', 'success']), ('Reservoir permeability', [150.0, 'md', 'Page 4, oil & gas exploration and production in Brazil.', 'not_mentioned | 150 mD@Page 4, oil & gas exploration and production in Brazil. | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned | not_mentioned', 'success']), ('Reservoir thickness', [np.nan, '', '', 'not_mentioned', 'success']), ('Wellhead pressure', [np.nan, '', '', 'not_mentioned', 'success']), ('Wellhead temperature', [np.nan, '', '', 'not_mentioned', 'success'])]))])
        gt = OrderedDict([('Buracica', OrderedDict([('Downhole pump', 1), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Buracica '), ('Field age', 64), ('Field depth', 1585), ('Oil production volume', np.nan), ('Number of producing wells', np.nan), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', 140), ('Offshore', 0), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 34), ('N2', np.nan), ('CO2', np.nan), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', 525), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Carmopolis', OrderedDict([('Downhole pump', 1), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Carmopolis '), ('Field age', 60), ('Field depth', 2297), ('Oil production volume', np.nan), ('Number of producing wells', np.nan), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', 122), ('Offshore', 0), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 24.5), ('N2', np.nan), ('CO2', np.nan), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', 100), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Canto do Amaro', OrderedDict([('Downhole pump', 1), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Canto do Amaro'), ('Field age', 37), ('Field depth', 1878.5), ('Oil production volume', np.nan), ('Number of producing wells', np.nan), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', 131), ('Offshore', 0), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 36.5), ('N2', np.nan), ('CO2', np.nan), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', 1070), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Jubarte', OrderedDict([('Downhole pump', 1), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Jubarte '), ('Field age', 22), ('Field depth', 3497), ('Oil production volume', np.nan), ('Number of producing wells', np.nan), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', 168.8), ('Offshore', 1), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 17), ('N2', np.nan), ('CO2', 2.04), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', np.nan), ('Reservoir thickness', 1148), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Marlim', OrderedDict([('Downhole pump', 1), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Marlim'), ('Field age', np.nan), ('Field depth', 2625), ('Oil production volume', np.nan), ('Number of producing wells', np.nan), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', 150), ('Offshore', 1), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 21.5), ('N2', np.nan), ('CO2', 0.12), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', np.nan), ('Reservoir thickness', 410), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Lula', OrderedDict([('Downhole pump', np.nan), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', np.nan), ('Gas lifting', np.nan), ('Gas flooding', 1), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Lula'), ('Field age', np.nan), ('Field depth', np.nan), ('Oil production volume', np.nan), ('Number of producing wells', 42), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', np.nan), ('Offshore', 1), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 31), ('N2', np.nan), ('CO2', 0.13), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', 3), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', 525), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Mero', OrderedDict([('Downhole pump', np.nan), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', np.nan), ('Gas lifting', np.nan), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Brasil'), ('Field name', 'Mero'), ('Field age', np.nan), ('Field depth', np.nan), ('Oil production volume', np.nan), ('Number of producing wells', 1), ('Number of water injecting wells', 1), ('Production tubing diameter', np.nan), ('Injector tubing diameter', np.nan), ('Bottomhole pressure', np.nan), ('Reservoir pressure', np.nan), ('Reservoir temperature', np.nan), ('Offshore', np.nan), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 29), ('N2', np.nan), ('CO2', 0.4), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', np.nan), ('Water-to-oil ratio (WOR)', np.nan), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', np.nan), ('Reservoir thickness', 1345.14), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)]))])

        file_path = Path(TEST_DIR, 'eval/result')
        metric = EvaluationMetric()

        metric.evaluate(str(file_path), pred, gt)

    def test_evaluation_without_gt(self):
        pred = OrderedDict([('Niger Delta', OrderedDict([('Downhole pump', [np.nan, '', '', 'not_mentioned']), ('Water reinjection', [np.nan, '', '', 'not_mentioned']), ('Natural gas reinjection', [np.nan, '', '', 'not_mentioned']), ('Water flooding', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas lifting', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas flooding', [np.nan, '', '', 'not_mentioned']), ('Steam flooding', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (non-integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Field location (Country)', ['Nigeria', '', 'Reference page and content', 'Nigeria@Reference page and content']), ('Field name', ['Niger Delta', '', '', 'Niger Delta']), ('Field age', ['58', '', '', '58']), ('Field depth', [np.nan, '', '', 'not_mentioned']), ('Oil production volume', [np.nan, '', '', 'not_mentioned']), ('Number of producing wells', [np.nan, '', '', 'not_mentioned']), ('Number of water injecting wells', [3.0, '', 'Reference page and content', '3@Reference page and content']), ('Production tubing diameter', [np.nan, '', '', 'not_mentioned']), ('Injector tubing diameter', ['3-1/2” or 2-7/8”', '', 'Reference page and content', '3-1/2” or 2-7/8”@Reference page and content']), ('Bottomhole pressure', [np.nan, '', '', 'not_mentioned']), ('Reservoir pressure', [3164.7, 'psia', 'Reference page and content', '3150psi@Reference page and content']), ('Reservoir temperature', [np.nan, '', '', 'not_mentioned']), ('Offshore', [0.0, '', 'Reference page and content', '0@Reference page and content']), ('API gravity (oil at standard pressure and temperature, or "dead oil")', [23.0, 'api', 'Reference page 1 and It is a normally pressured system with initial datum pressure of 3150psi. Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).', '23 API@Reference page 1 and It is a normally pressured system with initial datum pressure of 3150psi. Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).']), ('N2', [np.nan, '', '', 'not_mentioned']), ('CO2', [np.nan, '', '', 'not_mentioned']), ('C1', [np.nan, '', '', 'not_mentioned']), ('C2', [np.nan, '', '', 'not_mentioned']), ('C3', [np.nan, '', '', 'not_mentioned']), ('C4+', [np.nan, '', '', 'not_mentioned']), ('H2S', [np.nan, '', '', 'not_mentioned']), ('Gas-to-oil ratio (GOR)', [np.nan, '', '', 'not_mentioned']), ('Water-to-oil ratio (WOR)', [np.nan, '', '', 'not_mentioned']), ('Water injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas lifting injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas flooding injection ratio', [np.nan, '', '', 'not_mentioned']), ('Flood gas', [np.nan, '', '', 'not_mentioned']), ('Fraction of CO2 breaking through to producers', [np.nan, '', '', 'not_mentioned']), ('Source of makeup CO2', [np.nan, '', '', 'not_mentioned']), ('Percentage of sequestration credit assigned to the oilfield', [np.nan, '', '', 'not_mentioned']), ('Steam-to-oil ratio (SOR)', [np.nan, '', '', 'not_mentioned']), ('Fraction of required fossil electricity generated onsite', [np.nan, '', '', 'not_mentioned']), ('Fraction of remaining natural gas reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of produced water reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via cogeneration', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via solar thermal', [np.nan, '', '', 'not_mentioned']), ('Heater/treater', [np.nan, '', '', 'not_mentioned']), ('Stabilizer column', [np.nan, '', '', 'not_mentioned']), ('Upgrader type', [np.nan, '', '', 'not_mentioned']), ('Flaring-to-oil ratio', [np.nan, '', '', 'not_mentioned']), ('Venting fraction (purposeful venting of post-flare gas)', [np.nan, '', '', 'not_mentioned']), ('Volume fraction of diluent', [np.nan, '', '', 'not_mentioned']), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', [np.nan, '', '', 'not_mentioned']), ('Reservoir permeability', [np.nan, '', '', 'not_mentioned']), ('Reservoir thickness', [np.nan, '', '', 'not_mentioned']), ('Wellhead pressure', [np.nan, '', '', 'not_mentioned']), ('Wellhead temperature', [np.nan, '', '', 'not_mentioned'])])), ('Niger Delta_1', OrderedDict([('Downhole pump', [np.nan, '', '', 'not_mentioned']), ('Water reinjection', [np.nan, '', '', 'not_mentioned']), ('Natural gas reinjection', [np.nan, '', '', 'not_mentioned']), ('Water flooding', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas lifting', [1.0, '', 'Reference page and content', 'mentioned@Reference page and content']), ('Gas flooding', [np.nan, '', '', 'not_mentioned']), ('Steam flooding', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Oil sands mine (non-integrated with upgrader)', [np.nan, '', '', 'not_mentioned']), ('Field location (Country)', ['Nigeria', '', 'Reference page and content', 'Nigeria@Reference page and content']), ('Field name', ['Niger Delta_1', '', '', 'Niger Delta_1']), ('Field age', ['13', '', '', '13']), ('Field depth', [np.nan, '', '', 'not_mentioned']), ('Oil production volume', [3600.0, 'bbl/d', 'Reference page and content', '3600 bopd@Reference page and content']), ('Number of producing wells', [8.0, '', 'Reference page and content', '8@Reference page and content']), ('Number of water injecting wells', [3.0, '', 'Reference page and content', '3@Reference page and content']), ('Production tubing diameter', ['2-7/8', '', 'Reference page and content', '2-7/8"@Reference page and content']), ('Injector tubing diameter', ['3-1/2 or 2-7/8', '', 'Reference page and content', '3-1/2" or 2-7/8"@Reference page and content']), ('Bottomhole pressure', [np.nan, '', '', 'not_mentioned']), ('Reservoir pressure', [3164.7, 'psia', 'Reference page and content', '3150psi@Reference page and content']), ('Reservoir temperature', [np.nan, '', '', 'not_mentioned']), ('Offshore', [0.0, '', 'Reference page and content', '0@Reference page and content']), ('API gravity (oil at standard pressure and temperature, or "dead oil")', [23.0, 'api', 'Reference page 1 and Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).', '23 API@Reference page 1 and Fluid properties are moderately light• (Rsi = 387scf/bbl ; Boi = 1.14rb/d, 3.53cp; Oil gravity of 23 API).']), ('N2', [np.nan, '', '', 'not_mentioned']), ('CO2', [np.nan, '', '', 'not_mentioned']), ('C1', [np.nan, '', '', 'not_mentioned']), ('C2', [np.nan, '', '', 'not_mentioned']), ('C3', [np.nan, '', '', 'not_mentioned']), ('C4+', [np.nan, '', '', 'not_mentioned']), ('H2S', [np.nan, '', '', 'not_mentioned']), ('Gas-to-oil ratio (GOR)', [np.nan, '', '', 'not_mentioned']), ('Water-to-oil ratio (WOR)', ['1.14', '', 'Reference page 1 and content: "Currently 2010), the reservoir block is produced by 8 conduits at 3,600 bopd, 3.5 Mmscfd and 40% avg BSW."', '1.14@Reference page 1 and content: "Currently 2010), the reservoir block is produced by 8 conduits at 3,600 bopd, 3.5 Mmscfd and 40% avg BSW."']), ('Water injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas lifting injection ratio', [np.nan, '', '', 'not_mentioned']), ('Gas flooding injection ratio', [np.nan, '', '', 'not_mentioned']), ('Flood gas', [np.nan, '', '', 'not_mentioned']), ('Fraction of CO2 breaking through to producers', [np.nan, '', '', 'not_mentioned']), ('Source of makeup CO2', [np.nan, '', '', 'not_mentioned']), ('Percentage of sequestration credit assigned to the oilfield', [np.nan, '', '', 'not_mentioned']), ('Steam-to-oil ratio (SOR)', [np.nan, '', '', 'not_mentioned']), ('Fraction of required fossil electricity generated onsite', [np.nan, '', '', 'not_mentioned']), ('Fraction of remaining natural gas reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of produced water reinjected', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via cogeneration', [np.nan, '', '', 'not_mentioned']), ('Fraction of steam generation via solar thermal', [np.nan, '', '', 'not_mentioned']), ('Heater/treater', [np.nan, '', '', 'not_mentioned']), ('Stabilizer column', [np.nan, '', '', 'not_mentioned']), ('Upgrader type', [np.nan, '', '', 'not_mentioned']), ('Flaring-to-oil ratio', [np.nan, '', '', 'not_mentioned']), ('Venting fraction (purposeful venting of post-flare gas)', [np.nan, '', '', 'not_mentioned']), ('Volume fraction of diluent', [np.nan, '', '', 'not_mentioned']), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', [np.nan, '', '', 'not_mentioned']), ('Reservoir permeability', [np.nan, '', '', 'not_mentioned']), ('Reservoir thickness', [np.nan, '', '', 'not_mentioned']), ('Wellhead pressure', [np.nan, '', '', 'not_mentioned']), ('Wellhead temperature', [np.nan, '', '', 'not_mentioned'])]))])
        gt = OrderedDict([('Niger Delta', OrderedDict([('Downhole pump', np.nan), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', 1), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Nigeria'), ('Field name', 'Niger Delta'), ('Field age', 58), ('Field depth', np.nan), ('Oil production volume', 10200), ('Number of producing wells', 4), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', 3.1875), ('Bottomhole pressure', np.nan), ('Reservoir pressure', 3164.7), ('Reservoir temperature', np.nan), ('Offshore', 0), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 23), ('N2', np.nan), ('CO2', np.nan), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', 784.31), ('Water-to-oil ratio (WOR)', 0), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', np.nan), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)])), ('Niger Delta_1', OrderedDict([('Downhole pump', np.nan), ('Water reinjection', np.nan), ('Natural gas reinjection', np.nan), ('Water flooding', 1), ('Gas lifting', 1), ('Gas flooding', np.nan), ('Steam flooding', np.nan), ('Oil sands mine (integrated with upgrader)', np.nan), ('Oil sands mine (non-integrated with upgrader)', np.nan), ('Field location (Country)', 'Nigeria'), ('Field name', 'Niger Delta'), ('Field age', 13), ('Field depth', np.nan), ('Oil production volume', 3600), ('Number of producing wells', 8), ('Number of water injecting wells', np.nan), ('Production tubing diameter', np.nan), ('Injector tubing diameter', 3.1875), ('Bottomhole pressure', np.nan), ('Reservoir pressure', 3164.7), ('Reservoir temperature', np.nan), ('Offshore', 0), ('API gravity (oil at standard pressure and temperature, or "dead oil")', 23), ('N2', np.nan), ('CO2', np.nan), ('C1', np.nan), ('C2', np.nan), ('C3', np.nan), ('C4+', np.nan), ('H2S', np.nan), ('Gas-to-oil ratio (GOR)', 972.22), ('Water-to-oil ratio (WOR)', 0.667), ('Water injection ratio', np.nan), ('Gas lifting injection ratio', np.nan), ('Gas flooding injection ratio', np.nan), ('Flood gas', np.nan), ('Fraction of CO2 breaking through to producers', np.nan), ('Source of makeup CO2', np.nan), ('Percentage of sequestration credit assigned to the oilfield', np.nan), ('Steam-to-oil ratio (SOR)', np.nan), ('Fraction of required fossil electricity generated onsite', np.nan), ('Fraction of remaining natural gas reinjected', np.nan), ('Fraction of produced water reinjected', np.nan), ('Fraction of steam generation via cogeneration', np.nan), ('Fraction of steam generation via solar thermal', np.nan), ('Heater/treater', np.nan), ('Stabilizer column', np.nan), ('Upgrader type', np.nan), ('Flaring-to-oil ratio', np.nan), ('Venting fraction (purposeful venting of post-flare gas)', np.nan), ('Volume fraction of diluent', np.nan), ('Excess pressure in injector well (injector well interface flowing pressure - avg res. pressure)', np.nan), ('Reservoir permeability', np.nan), ('Reservoir thickness', np.nan), ('Wellhead pressure', np.nan), ('Wellhead temperature', np.nan)]))])
        file_path = Path(TEST_DIR, 'eval/result')
        metric = EvaluationMetric()

        metric.evaluate(str(file_path), pred, gt)
